"use strict";(()=>{var i={},b=()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER),d=new Promise(e=>self.onmessage=e),k=async({request:e})=>{let a;for(;(a=b())in i;);let{body:t,cache:s,credentials:r,headers:c,integrity:l,keepalive:m,method:h,mode:p,redirect:E,referrer:T,referrerPolicy:f,url:u}=e,w=Object.fromEntries(c.entries());return(await d).data.postMessage({code:"REQUEST",id:a,data:[t,s,r,w,l,m,h,p,E,T,f,u]}),await new Promise(o=>i[a]=o).then(([o,M,g,P])=>new Response(o,{headers:M,status:g,statusText:P}))},v=new BroadcastChannel(""),n=()=>setTimeout(()=>v.close(),3e3);d.then(({data:e})=>{let a=n();e.onmessage=({data:{code:t,id:s,data:r}})=>{switch(t){case"HEARTBEAT":{clearTimeout(a),a=n();break}default:i[s]?.(r)}},e.postMessage({code:"CONNECT"})});self.addEventListener("fetch",e=>e.respondWith(k(e)));})();
