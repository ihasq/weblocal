"use strict";(()=>{var i={},a=()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER),l=new Promise(e=>self.onmessage=e),h=BigInt(""+a()+a()+a()+a()).toString(36),C=async({request:e})=>{let t;for(;(t=a())in i;);let{body:s,cache:n,credentials:r,headers:m,integrity:p,keepalive:g,method:T,mode:f,redirect:E,referrer:u,referrerPolicy:w,url:d}=e;if(URL.parse(d)?.pathname==`/${h}`)return new Response("",{headers:{"Content-Type":"text/html"}});let M=Object.fromEntries(m.entries());return(await l).data.postMessage({code:"REQUEST",id:t,data:[s,n,r,M,p,g,T,f,E,u,w,d]}),await new Promise(o=>i[t]=o).then(([o,R,v,y])=>new Response(o,{headers:R,status:v,statusText:y}))},P=new BroadcastChannel(""),c=()=>setTimeout(()=>P.close(),3e3);l.then(({data:e})=>{let t=c();e.onmessage=({data:{code:s,id:n,data:r}})=>{switch(s){case"HEARTBEAT":{clearTimeout(t),t=c();break}default:i[n]?.(r)}},e.postMessage({code:"CONNECT",data:h})});self.addEventListener("fetch",e=>e.respondWith(C(e)));setInterval(()=>fetch("./ping.txt"),20*1e3);})();
