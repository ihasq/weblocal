"use strict";(()=>{var a={},g=()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER),u=new DecompressionStream("gzip"),c=new BroadcastChannel(location.hash),S=({request:e})=>{let t;for(;(t=g())in a;);let{body:n,cache:s,credentials:r,headers:o,integrity:i,keepalive:d,method:l,mode:h,redirect:m,referrer:p,referrerPolicy:E,url:w}=e,y=Object.fromEntries(o.entries());return c.postMessage({code:"REQUEST",id:t,data:[n,s,r,y,i,d,l,h,m,p,E,w]}),new Promise(f=>a[t]=f)};self.addEventListener("fetch",e=>e.respondWith(S(e)));self.addEventListener("install",e=>e.waitUntil((async()=>{new BroadcastChannel("--weblocal-connection-signal").postMessage(await crypto.subtle.encrypt({name:"RSA-OAEP",hash:"SHA-512"},key,Uint8Array.from(channelTag,t=>t.codePointAt(0))))})()));c.onmessage=({data:{code:e,id:t,data:n}})=>{switch(e){case"RESPONSE":{let[s,r,o,i]=n;a[t]?.(new Response(s.stream().pipeThrough(u),{headers:r,status:o,statusText:i})),delete a[t];break}}};})();
